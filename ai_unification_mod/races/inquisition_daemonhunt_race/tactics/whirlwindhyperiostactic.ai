----------------------------------------
-- File: 'whirlwindhyperiostactic.ai'
-- Edited by Gambit @ 03.04.2020

class 'WhirlwindHyperiosTactic' (DaemonhuntVehicleGKTactic)

GKHyperios = {}

function WhirlwindHyperiosTactic:__init( squad_ai ) super( squad_ai )

	self:SetName("Grey Knights Whirlwind Hyperios Tactic")
end


function WhirlwindHyperiosTactic:InitAbilities()

	if (GKHyperios.incendiary_id == nil) then
	    GKHyperios.incendiary_id = cpu_manager.stats:GetAbilityID( "inquisition_whirlwind_incendiary_missile" )	
	end
end


function WhirlwindHyperiosTactic:DoAbilities()

	if self.squad_ai:CanDoAbility(GKHyperios.incendiary_id) then
		-- Enable Incendiary Missile barrage only when attacking and with enough health (Whirlwind Hyperios)
		if self.squad_ai:IsUsingAbility(GKHyperios.incendiary_id) then
			-- Turn barrage OFF if stopped attacking, OR if health < 50%
			if not self.squad_ai:IsAttacking() or self.squad_ai:GetHealthPercentage() < 0.5 then
				self.squad_ai:DoSpecialAbility(GKHyperios.incendiary_id)
			end
			-- Turn barrage ON only when attacking, AND when health > 50%
		elseif self.squad_ai:IsAttacking() and self.squad_ai:GetHealthPercentage() > 0.5 then
			self.squad_ai:DoSpecialAbility(GKHyperios.incendiary_id)
		end
	end
end

