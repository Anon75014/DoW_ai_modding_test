----------------------------------------
-- File: 'damoclestactic.ai'
-- Edited by Gambit @ 03.04.2020

class 'DamoclesTactic' (DaemonhuntVehicleGKTactic)

GKDamocles = {}

function DamoclesTactic:__init( squad_ai ) super( squad_ai )

	self:SetName("Grey Knights Damocles Tactic")
end


function DamoclesTactic:InitAbilities()

	if (GKDamocles.sensor_id == nil) then
		GKDamocles.sensor_id  = cpu_manager.stats:GetAbilityID( "inquisition_sensormap" )	
	    GKDamocles.orbital_id = cpu_manager.stats:GetAbilityID( "inquisition_orbital_bombardment_damocles" )	
	end
end


function DamoclesTactic:DoAbilities()

	-- Enable Reveal Map Area around Damocles
	if self.squad_ai:CanDoAbility(GKDamocles.sensor_id) and (not self.squad_ai:IsUnderAttack())
	and cpu_manager.terrain_analyzer:HasThreat(self.squad_ai:GetPosition(), 100) then
		self.squad_ai:DoSpecialAbility(GKDamocles.sensor_id) 
	end
	
	-- Check if we can make an orbital strike
	if self.squad_ai:CanDoAbility(GKDamocles.orbital_id) then
		if Ability.DoAbilityPos(self.squad_ai, GKDamocles.orbital_id, Ability.Filters.CloseEnemy, 24)
		or Ability.DoAbilityPos(self.squad_ai, GKDamocles.orbital_id, Ability.EntityFilters.CloseBaseEntityEnemy, 3)
		then end
	end
end

