----------------------------------------
-- File: 'loader.ai'
-- Edited by Thudmeizer	@ 16.09.2025

class 'inquisition_daemonhunt_race'

-- Constructor
function inquisition_daemonhunt_race:__init()

end

-- Returns the name of the race
function inquisition_daemonhunt_race:GetRaceName()
	return "inquisition_daemonhunt_race"
end

-- This function is called if the race is being played
function inquisition_daemonhunt_race:LoadRace( eDifficulty )

	-- Import generic abilities
	import( 'Races/inquisition_daemonhunt_race/Tactics/idh__abilities.ai' )
	
	-- Import strategies
	import( 'Races/inquisition_daemonhunt_race/Strategies/DaemonhuntBuildBaseStrategy.ai' )
	
	-- Import strategy info
	import( "Races/inquisition_daemonhunt_race/Strategies/DaemonhuntStrategyInfo.ai" )
		
	-- Import tactics
	import( 'Races/inquisition_daemonhunt_race/Tactics/Daemonhunt_InfantryTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/Daemonhunt_VehicleTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/ArchivistTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/MaintenanceTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/ShockTrooperTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/BodyGuardTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/ScholarsTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/GKTermieTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/DeathCultistTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/GKHeroTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/LibrarianGKTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/DaemonHostTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/ChaplainGKTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/DHLordTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/DHLordFemaleTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/DHLordSabbathielTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/DHRhinoTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/DHChimeraTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/DHVindicatorTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/DHLandRaiderTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/DHLandRaiderCrusaderTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/DHBanebladeTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/AstraTelepathicaTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/DHWatchTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/GreyKnightTransporterTactic.ai' )

	import( 'Races/inquisition_daemonhunt_race/Tactics/Daemonhunt_InfantryGKTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/Daemonhunt_VehicleGKTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/AcolyteTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/DHLordGKTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/DHCroweTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/TechmarineTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/ApothecaryTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/PaladinGKTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/InterceptorTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/CladeAdamusTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/GKHeroGKTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/DHLordGarithosTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/LibrarianTermiTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/BrotherhoodChampionTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/ExorcistTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/RazorbackTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/DamoclesTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/StormRavenTactic.ai' )
	
	import( 'Races/inquisition_daemonhunt_race/Tactics/WhirlwindHyperiosTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/StormhawkTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/PsiTitanTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/KaldorDraigoTactic.ai' )

	-- Last Standing / Kill Team
	import( 'Races/inquisition_daemonhunt_race/Tactics/DHLordKtgmTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/DHResearchKtgmTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/PaladinGK_KTGM_Tactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/DaemonHostKtgmTactic.ai' )

	-- Single Player Campaign
	import( 'Races/inquisition_daemonhunt_race/Tactics/BodyGuardSPTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/ShockTrooperSPTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/AstropathSPTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/InterceptorSPTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/PurgatorSPTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/PaladinSPTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/ApothecarySPTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/BrotherhoodChampionSPTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/ChaplainSPTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/LibrarianTermiSPTactic.ai' )
	import( 'Races/inquisition_daemonhunt_race/Tactics/DHLordSPTactic.ai' )

 	-- GAMBIT: New Method of returning a squad or base Tactic (from the CreateTactic function). Indexes.
	-- Here follows a Global List with all the squad names as indexes, and their Tactics as values
	-- The name of the Global List must be unique for each race.
    	DH_Race_Squad_Tactic =
    	{
        -- Insert here SQUAD_NAME or BASE_NAME and the TACTIC NAME (with the comma at the end!)
        -- If a squad must NOT have a Tactic attached to it AT ALL, use "NONE" (with quotes, case sensitive).
        -- Suggestion: Better put all in alphabetical order (sorted by squad names) for easier reference

	-- Check if there is a special tactic for the unit available, based on branch chosen
        inquisition_squad_archivist = ArchivistTactic,
        inquisition_squad_archivist_gk = ArchivistTactic,
        inquisition_squad_stormhawk_interceptor = StormhawkTactic,
        inquisition_squad_whirlwind_hyperios = WhirlwindHyperiosTactic,
        inquisition_squad_psi_titan = PsiTitanTactic,

	-- Last Standing / Kill Team / Single Player
        inquisition_squad_daemonhost_lesser_ktgm = DaemonHostKtgmTactic,
        inquisition_squad_grey_knights_paladin_ktgm = PaladinGK_KTGM_Tactic,
        inquisition_squad_inquisitor_lord_ktgm = DHLordKtgmTactic,

	-- Single Player Campaign
        inquisition_squad_bodyguard_advance_sp = BodyGuardSPTactic,
        inquisition_squad_shock_troops_advance_sp = ShockTrooperSPTactic,
        inquisition_squad_shock_troops_sp_dxp3_prisoner = ShockTrooperSPTactic,
        inquisition_squad_scholar_astropath_sp = AstropathSPTactic,
        inquisition_squad_grey_knights_interceptors_advance_sp = InterceptorSPTactic,
        inquisition_squad_grey_knights_interceptors_sp_dxp3_prisoner = InterceptorSPTactic,
        inquisition_squad_grey_knights_purgation_advance_sp = PurgatorSPTactic,
        inquisition_squad_grey_knights_purgation_sp_dxp3_prisoner = PurgatorSPTactic,
        inquisition_squad_grey_knights_paladin_advance_sp = PaladinSPTactic,
        inquisition_squad_grey_knights_apothecary_advance_sp = ApothecarySPTactic,
        inquisition_squad_brotherhood_champion_advance_sp = BrotherhoodChampionSPTactic,
        inquisition_squad_gk_chaplain_advance_sp = ChaplainSPTactic,
        inquisition_squad_grey_knights_librarian_advance_sp = LibrarianTermiSPTactic,
        inquisition_squad_inquisitor_lord_cs_advance_sp = DHLordSPTactic,

	-- Grey Knight Branch
        inquisition_squad_acolyte = AcolyteGKTactic,
        inquisition_squad_techmarine = TechmarineGKTactic,
        inquisition_squad_exorcist_sister = ExorcistTactic,
        inquisition_squad_grey_knights_interceptors = InterceptorGKTactic,
        inquisition_squad_grey_knights_paladin = PaladinGKTactic,
        inquisition_squad_inquisitor_lord_cs = DHLordGKTactic,
        inquisition_squad_castellan_garran_crowe = DHCroweTactic,
        inquisition_squad_grey_knights_apothecary = ApothecaryGKTactic,
        inquisition_squad_brotherhood_champion = BrotherhoodChampionTactic,
        inquisition_squad_grey_knight_hero_gk = GKHeroGKTactic,
	inquisition_squad_gk_lord_garithos = DHLordGarithosTactic,
        inquisition_squad_master_kaldor_draigo = KaldorDraigoTactic,
        inquisition_squad_grey_knights_librarian = LibrarianTermiTactic,
        inquisition_squad_razorback = RazorbackTactic,
        inquisition_squad_rhino_gk = DHRhinoTactic,
        inquisition_squad_chimera_transport_gk = DHChimeraTactic,
        inquisition_squad_vindicator = DHVindicatorTactic,
        inquisition_squad_damocles = DamoclesTactic,
        inquisition_squad_stormraven_fury = StormRavenTactic,
	inquisition_squad_stormraven_fury_entrenched = StormRavenTactic,

	-- Inquisition Branch
        inquisition_squad_servitor_maintenance = MaintenanceTactic,
        inquisition_squad_bodyguard = BodyGuardTactic,
        inquisition_squad_shock_troops = ShockTrooperTactic,
        inquisition_squad_scholars = ScholarsTactic,
        inquisition_squad_gk_apothecary = ApothecaryGKTactic,
        inquisition_squad_grey_knights_terminator = GKTermieTactic,
        inquisition_squad_daemonhost_greater = DaemonHostTactic,
	inquisition_squad_daemonhost_lesser = DaemonHostTactic,
	inquisition_squad_daemonhost_rogue = DaemonHostTactic,
        inquisition_squad_adamus = CladeAdamusTactic,
        inquisition_squad_grey_knight_hero = GKHeroTactic,
        inquisition_squad_master_kaldor_draigo = KaldorDraigoTactic,
        inquisition_squad_gk_librarian = LibrarianGKTactic,
        inquisition_squad_gk_chaplain = ChaplainGKTactic,
        inquisition_squad_death_cultist = DeathCultistTactic,
        inquisition_squad_inquisitor_female = DHLordFemaleTactic,
        inquisition_squad_astor_sabbathiel = DHLordSabbathielTactic,
        inquisition_squad_inquisitor_lord = DHLordTactic,
        inquisition_squad_rhino = DHRhinoTactic,
        inquisition_squad_chimera_transport = DHChimeraTactic,
        inquisition_squad_land_raider = DHLandRaiderTactic,
	inquisition_squad_land_raider_redeemer = DHLandRaiderTactic,
        inquisition_squad_land_raider_crusader = DHLandRaiderCrusaderTactic,
	inquisition_squad_baneblade = DHBanebladeTactic,
	}

    	DH_Race_Base_Tactic =
	{
        inquisition_astra_telepathica = AstraTelepathicaTactic,
        inquisition_watch = DHWatchTactic,
        inquisition_grey_knights_teleporter = GreyKnightTransporterTactic,
	inquisition_grey_knights_teleporter_gk = GreyKnightTransporterTactic,
	inquisition_astra_telepathica_gk = GreyKnightTransporterTactic,
        inquisition_research_ktgm = DHResearchKtgmTactic,
	}
	return true
end

-- This function is called even if this race are not the race being played
function inquisition_daemonhunt_race:LoadGlobalInfo()
		
	-- Import info files
	import( 'Races/inquisition_daemonhunt_race/Info/daemonhuntunitstats.ai' )
	
	-- Add unit stats
	table.insert(UnitStats, DaemonhuntUnitStats)
	return true
end

-- Creates build base strategy
function inquisition_daemonhunt_race:CreateBuildBaseStrategy()
	return DaemonhuntBuildBaseStrategy(BuildBaseStrategyInfo)
end

-- Creates a special tactic for units
-- GAMBIT: Updated version, with no IFs at all, much faster and reliable. CPU utilization nigh zero
function inquisition_daemonhunt_race:CreateTactic(oSquadAI)

    	-- Get unit name, and see if there is an attached tactic to it
    	local sUnitName = oSquadAI:GetSquadName()    
	if sUnitName ~= nil and DH_Race_Squad_Tactic[sUnitName] ~= nil then
		if DH_Race_Squad_Tactic[sUnitName] == "NONE" then
            		-- The squad must have NO tactic. Return nil.
            		return nil
        	else
            		return DH_Race_Squad_Tactic[sUnitName](oSquadAI)
        	end
    	end

	if (oSquadAI:IsEngineer()) then
		return nil
	end

	if cpu_manager.cpu_player:IsResearchComplete( "inquisition_branch_gk" ) then

		-- Get class
		local eClass = oSquadAI:GetStats():GetClass()

		-- Check if there is a special tactic for the unit available
		local bVehicle = (eClass == UnitStatsAI.UC_VehicleLow or eClass == UnitStatsAI.UC_VehicleMed or eClass == UnitStatsAI.UC_VehicleHigh)
		local bAirPlane = (eClass == UnitStatsAI.UC_AirLow or eClass == UnitStatsAI.UC_AirMed or eClass == UnitStatsAI.UC_AirHigh)

		if (bVehicle or bAirPlane) then
			return DaemonhuntVehicleGKTactic(oSquadAI)
		end
		return DaemonhuntInfantryGKTactic(oSquadAI)

	elseif cpu_manager.cpu_player:IsResearchComplete( "inquisition_branch_inq" ) then

		-- Get class
		local eClass = oSquadAI:GetStats():GetClass()

		-- Check if there is a special tactic for the unit available
		local bVehicle = (eClass == UnitStatsAI.UC_VehicleLow or eClass == UnitStatsAI.UC_VehicleMed or eClass == UnitStatsAI.UC_VehicleHigh)
		local bAirPlane = (eClass == UnitStatsAI.UC_AirLow or eClass == UnitStatsAI.UC_AirMed or eClass == UnitStatsAI.UC_AirHigh)

		if (bVehicle or bAirPlane) then
			return DaemonhuntVehicleTactic(oSquadAI)
		end
		return DaemonhuntInfantryTactic(oSquadAI)
	end
end

-- Creates a special tactic for buildings
-- GAMBIT: Updated version, with no IFs at all, much faster and reliable. CPU utilization nigh zero
function inquisition_daemonhunt_race:CreateBaseTactic(oBuilding)

	-- Get building name
	local sBuildingName = oBuilding:GetBaseName()
	if sBuildingName ~= nil and DH_Race_Base_Tactic[sBuildingName] ~= nil then
		if DH_Race_Base_Tactic[sBuildingName] == "NONE" then
            		-- The building must have NO tactic. Return nil.
            		return nil
        	else
            		return DH_Race_Base_Tactic[sBuildingName](oBuilding)
        	end
    	end
	return nil
end

-- Returns a specific information
function inquisition_daemonhunt_race:GetInfo(sType)

	-- Check info type
	if (sType == "TurretPower") then
		return 400
	elseif (sType == "SupportAllyFactor") then
		return 8 / 4
	elseif (sType == "AttackModifier") then
		return 10
	elseif (sType == "CriticalRangeIncreasePerTier") then
		return 10
	elseif (sType == "MinArmyStrengthPerTier") then
		return 750
	elseif (sType == "AttackRatio") then
		return 4 / 5
	elseif (sType == "RetreatRatio") then
		return 3 / 5
	elseif (sType == "InvisibleBuildings") then
		return false
	elseif (sType == "HarassingLeader") then
		if cpu_manager.cpu_player:IsResearchComplete("inquisition_branch_inq") then
			return "inquisition_squad_inquisitor_lord"
		elseif cpu_manager.cpu_player:IsResearchComplete("inquisition_branch_gk") then
			return "inquisition_squad_inquisitor_lord_cs"
		end
	elseif (sType == "AutoConstructBuildings") then
		return false
	end
	return nil
end

-- Returns the building type and threat
function inquisition_daemonhunt_race:GetBuildingType(sBuildingName)

	-- Return race specific object string
	if (sBuildingName == "inquisition_tower_hq") then
		return "HQ", 0
		
	elseif (sBuildingName == "inquisition_warp_generator") then
		return "Generator", 0
		
	elseif (sBuildingName == "inquisition_warp_reactor") then
		return "BiggerGenerator", 0
		
	elseif (sBuildingName == "inquisition_watch") then
		return "VehicleBuilding", 0

	elseif (sBuildingName == "inquisition_astra_telepathica_gk") then
		return "VehicleBuilding", 0

	elseif (sBuildingName == "inquisition_librarium") then
		return "Armoury", 100
		
	elseif (sBuildingName == "inquisition_imperial_icon") then
		return "ListeningPost", 0

	elseif (sBuildingName == "inquisition_purification_decree") then
		return "Turret", 300
	end
	return nil, 0
end
