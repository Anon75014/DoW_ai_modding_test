----------------------------------------
-- File: 'squatstactic.ai'
-- Edited by Thudmeizer @ 28.11.2024

class 'SquatsTactic' (TauInfantryTactic)

Squats = {}

function SquatsTactic:__init( squad_ai ) super( squad_ai )

	self:SetName("Squats Tactic")
	self.lastPhotonTm = g_iGMT
	self.lastStimpackTm = g_iGMT
end

function SquatsTactic:InitAbilities()

	-- Init ability ID's
	if Squats.photon == nil then
		Squats.photon = cpu_manager.stats:GetAbilityID( "tau_photon_grenade" )
		Squats.stimpack = cpu_manager.stats:GetAbilityID( "tau_votann_stimpack" )
	end
end

function SquatsTactic:DoAbilities()

	if self.squad_ai:IsInCombat() then
		if g_iGMT > self.lastPhotonTm + 6 and self.squad_ai:CanDoAbility(Squats.photon) then
			if Ability.DoAbilityTarget(self.squad_ai, Squats.photon, Ability.Filters.CloseSquadEnemy, 1) then
				self.lastPhotonTm = g_iGMT
				return
			end
		end
	end

	if g_iGMT > self.lastStimpackTm + 6 and self.squad_ai:WasRecentlyHurt() or self.squad_ai:IsBroken() then
		if Ability.DoAbility( self.squad_ai, Squats.stimpack, Ability.PredicateFilters.IsInCombat ) then
			self.lastStimpackTm = g_iGMT
		end
	end
	
	-- Call basic DoAbilities methods
	InfantryTactic.DoAbilities(self)
end
