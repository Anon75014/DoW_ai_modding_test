----------------------------------------
-- File: 'lotdlisteningposttactic.ai'
-- Edited by Arkhan		@ 24.10.2006
-- Edited by fuggles		@ 06.06.16
-- Edited by Thudmeizer		@ 05.08.2023

class 'LOTDListeningPostTactic' (BaseTactic)

LOTDListeningPost = {}

function LOTDListeningPostTactic:__init( base_ai ) super( base_ai )

	self.forced_labour = false

	self:SetName("LOTD Listening Post Tactic")
end

function LOTDListeningPostTactic:InitAbilities()
	
	-- Init abilities
	if (LOTDListeningPost.phase_id == nil) then
		LOTDListeningPost.phase_id = cpu_manager.stats:GetAbilityID( "lotd_phase_shifter_2" )
	end

	if (LOTDListeningPost.labor_id == nil) then
		LOTDListeningPost.labor_id = cpu_manager.stats:GetAbilityID( "lotd_forced_labor" )
	end
end

function LOTDListeningPostTactic:DoAbilities()
	
	if (self.base_ai:GetHealthPercentage() < 0.5) then
		Ability.DoAbilityArea(self.base_ai, LOTDListeningPost.phase_id, Ability.Filters.CloseEnemy, 20, 1)
	end

	-- Forced labour if we're doing well
	if (self.base_ai:GetHealthPercentage() > 0.6 and not self.forced_labour) then

		-- Turn on ability
		self.base_ai:DoSpecialAbility( LOTDListeningPost.labor_id )
		self.forced_labour = true

	elseif (self.forced_labour and self.base_ai:GetHealthPercentage() < 0.6) then

		-- Turn off ability
		self.base_ai:DoSpecialAbility( LOTDListeningPost.labor_id )
		self.forced_labour = false
	end
end

