----------------------------------------
-- File: 'praetorian_kommandotactic.ai'
-- Edited by fuggles	@ 06.10.2016
-- Edited by Thudmeizer @ 08.11.2022

class 'Praetorian_KommandoTactic' (Praetorian_InfantryTactic)

Praetorian_Kommando = {}

function Praetorian_KommandoTactic:__init( squad_ai ) super( squad_ai )

	self:SetName("Praetorian Kommando Tactic")
end

function Praetorian_KommandoTactic:InitAbilities()

	-- Init ability ID's
	if Praetorian_Kommando.bomma_id == nil then
		Praetorian_Kommando.bomma_id = cpu_manager.stats:GetAbilityID( "praetorian_orka_airstrike" )
	end
	if Praetorian_Kommando.melta_id == nil then
		Praetorian_Kommando.melta_id = cpu_manager.stats:GetAbilityID( "praetorian_ork_tankbusta_bombs" )
	end
	if Praetorian_Kommando.rally_id == nil then
		Praetorian_Kommando.rally_id = cpu_manager.stats:GetAbilityID( "praetorian_ork_rally2" )
	end
end

function Praetorian_KommandoTactic:DoAbilities()

	Ability.DoAbilityPos(self.squad_ai, Praetorian_Kommando.bomma_id, Ability.Filters.CloseEnemy, 24)
	Ability.DoAbilityPos(self.squad_ai, Praetorian_Kommando.bomma_id, Ability.EntityFilters.CloseBaseEntityEnemy, 3)
	Ability.DoAbilityTarget(self.squad_ai, Praetorian_Kommando.melta_id , Ability.Filters.CloseVehicleEnemy, 1)

	Praetorian_InfantryTactic.DoAbilities(self)
end
 
function Praetorian_KommandoTactic:CheckForBroken()

	if (self.squad_ai:IsBroken()) then
	
		-- Check if I can repair my morale
		if (self.squad_ai:CanDoAbility( Praetorian_Kommando.rally_id )) then
			self.squad_ai:DoSpecialAbility( Praetorian_Kommando.rally_id )
		end
	end

	-- Call basic broken check method
	Praetorian_InfantryTactic.CheckForBroken(self)
end
