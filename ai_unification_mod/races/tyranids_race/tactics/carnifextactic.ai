---------------------------------
-- File: 'carnifextactic.ai'
-- Edited by Gambit @ 25.05.2022

class 'CarnifexTactic' (TyranidInfantryTactic)

Carnifex = {}


function CarnifexTactic:__init( squad_ai ) super( squad_ai )
	self:SetName("Carnifex and Warriors Tactic")
end


function CarnifexTactic:InitAbilities()
	if Carnifex.bioplasma_warrior_id == nil then
		Carnifex.bioplasma_warrior_id = cpu_manager.stats:GetAbilityID( "tyranids_bioplasma" )
		Carnifex.bioplasmaCarnifex_id = cpu_manager.stats:GetAbilityID( "tyranids_bioplasma_fex" )
		Carnifex.regenOldOneEye_id = cpu_manager.stats:GetAbilityID( "tyranids_oldoneeye_regenerate" )
	end
end


function CarnifexTactic:DoAbilities()
	if self.squad_ai:CanDoAbility(Carnifex.regenOldOneEye_id) and self.squad_ai:GetHealthPercentage() < 0.6 then
		if self.squad_ai:DoSpecialAbility(Carnifex.regenOldOneEye_id) then
			return
		end
	end

	if self.squad_ai:IsInCombat() then
		if self.squad_ai:CanDoAbility(Carnifex.bioplasma_warrior_id) then
			if Ability.DoAbilityTarget(self.squad_ai, Carnifex.bioplasma_warrior_id, Ability.Filters.CloseSquadEnemy, 3)
			or Ability.DoAbilityTarget(self.squad_ai, Carnifex.bioplasma_warrior_id, Ability.Filters.CloseCommanderEnemy, 1) then
				return
			end
		elseif self.squad_ai:CanDoAbility(Carnifex.bioplasmaCarnifex_id) then
			if Ability.DoAbilityTarget(self.squad_ai, Carnifex.bioplasmaCarnifex_id, Ability.Filters.CloseSquadEnemy, 3)
			or Ability.DoAbilityTarget(self.squad_ai, Carnifex.bioplasmaCarnifex_id, Ability.Filters.CloseCommanderEnemy, 1) then
				return
			end
		end
	end
end
