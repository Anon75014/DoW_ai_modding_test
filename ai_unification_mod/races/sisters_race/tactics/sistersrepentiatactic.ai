----------------------------------------
-- File: 'sistersrepentiatactic.ai'
-- Created by Gambit	@ 23.11.2021

class 'SistersRepentiaTactic' (SistersInfantryTactic)

SistersRepentia = {}

function SistersRepentiaTactic:__init( squad_ai ) super( squad_ai )

	self:SetName("Sisters Repentia Tactic")
end


function SistersRepentiaTactic:InitAbilities()

	-- Init ability ID's
	if SistersRepentia.fervor_id == nil then
		SistersRepentia.fervor_id = cpu_manager.stats:GetAbilityID("sisters_righteous_fervor")
	end
end


function SistersRepentiaTactic:DoAbilities()

	local do_it = self.squad_ai:IsInCombat() and self.squad_ai:IsAttacking() and self.squad_ai:GetHealthPercentage() > 0.4
					and not (self.squad_ai:IsCapturing() or self.squad_ai:IsBroken())
	local using_it = self.squad_ai:IsUsingAbility(SistersRepentia.fervor_id)

	-- Use Righteous Fervour if the conditions are met
	if using_it and not do_it then
		-- Stop
		self.squad_ai:DoSpecialAbility(SistersRepentia.fervor_id)
	elseif not using_it and do_it then
		-- Enable it
		self.squad_ai:DoSpecialAbility(SistersRepentia.fervor_id)
	end

	-- Call basic DoAbilities methods
	SistersInfantryTactic.DoAbilities(self)
end
