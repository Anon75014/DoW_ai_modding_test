----------------------------------------
-- File: 'enclavesstriketactic.ai'
-- Edited by Thudmeizer			@ 26.02.2024

class 'EnclavesStrikeTactic' (EnclavesInfantryTactic)

EnclavesStrike = {}

function EnclavesStrikeTactic:__init( squad_ai ) super( squad_ai )

	self:SetName("Enclaves Strike Squad Tactic")
end

function EnclavesStrikeTactic:InitAbilities()
--[[
	if (EnclavesStrike.shockwave_id == nil) then
		EnclavesStrike.shockwave_id = cpu_manager.stats:GetAbilityID( "enclaves_antigrav_shockwave" )	
	end
]]
end

function EnclavesStrikeTactic:DoAbilities()
--[[
	-- We are dying, lower requisites for attacks
	if (self.squad_ai:WasRecentlyHurt() and self.squad_ai:GetHealthPercentage() < 0.4) then
 		Ability.DoAbilityArea( self.squad_ai, EnclavesStrike.shockwave_id, Ability.Filters.CloseEnemy, 2 )
	else
 		Ability.DoAbilityArea( self.squad_ai, EnclavesStrike.shockwave_id, Ability.Filters.CloseEnemy, 6 )
	end
]]
	-- Call basic DoAbilities methods
	InfantryTactic.DoAbilities(self)
end

function EnclavesStrikeTactic:Reinforce()

	if not self.squad_ai:IsReinforcing() then

		-- try for different types of squad members
		local SergeantIndex = 0
		local GravIndex = 1
		local PulseIndex = 2
	
		-- Get current leader count
		local numSergeant = self.squad_ai:GetLeaderCount( SergeantIndex )
		local numGrav = self.squad_ai:GetLeaderCount( GravIndex )
		local numPulse = self.squad_ai:GetLeaderCount( PulseIndex )

		-- Desired number of each leader type
		local desiredSergeant = math.random(0,1)
		local desiredGrav = math.random(0,1)
		local desiredPulse = math.random(0,1)

		-- Desired order of reinforcing
		if numSergeant < desiredSergeant then
			if self.squad_ai:CanReinforce( true, SergeantIndex ) then
				self.squad_ai:DoReinforce( true, SergeantIndex )
			end

		elseif numGrav < desiredGrav then
			if self.squad_ai:CanReinforce( true, GravIndex ) then
				self.squad_ai:DoReinforce( true, GravIndex )
			end

		elseif numPulse < desiredPulse then
			if self.squad_ai:CanReinforce( true, PulseIndex ) then
				self.squad_ai:DoReinforce( true, PulseIndex )
			end
		end
	end
end