----------------------------------------
-- File: 'Mimetactic.ai'
-- Edited by Thudmeizer @ 23.02.2009

class 'MimeTactic' (HarlequinInfantryTactic)

Mime = {}

function MimeTactic:__init( squad_ai ) super( squad_ai )

        self:SetName("Mime Tactic")
end

function MimeTactic:InitAbilities()

	if (Mime.disruption_id == nil) then
		Mime.disruption_id = cpu_manager.stats:GetAbilityID( "harlequin_disruption" )
	end

end

function MimeTactic:DoAbilities()

	self:DoThrowGrenades()

        --Target: Use against Vehicles and Buildings
	Ability.DoAbilityTarget( self.squad_ai, Mime.disruption_id, Ability.Filters.CloseVehicleEnemy, 1 ) 
	Ability.DoAbilityTargetEntity(self.squad_ai, Mime.disruption_id, Ability.EntityFilters.CloseBaseEntityEnemy, 1)

	HarlequinInfantryTactic.DoAbilities(self)
end

--[[function MimeTactic:Reinforce()

	-- Check ressources
	local iRequisition = resource_manager:GetResourceAmount():Get( ResourceAmount.RT_Requisition )
	local iPower = resource_manager:GetResourceAmount():Get( ResourceAmount.RT_Power )

		if (iRequisition > 300 and iPower > 150 and cpu_manager:GetTierLevel() >= 2) then

        local use_leader = false
        if self.squad_ai:CanReinforce( use_leader, 0 ) then
            self.squad_ai:DoReinforce( use_leader, 0 )
	end
    end
end

function MimeTactic:Upgrade()

	-- Check ressources
	local iRequisition = resource_manager:GetResourceAmount():Get( ResourceAmount.RT_Requisition )
	local iPower = resource_manager:GetResourceAmount():Get( ResourceAmount.RT_Power )

		-- Check resources
		if (iRequisition > 250 and iPower > 100) then

		-- Upgrade if possible
		if (self.squad_ai:HasUpgradableTrooper() and self.squad_ai:GetNumTroopers() > 2) then
			local class_type = cpu_manager:GetFirstEnemyPlayer():GetMajorityClassType()
			self.squad_ai:DoBestUpgrade( class_type )
		end
	end
end]]

--[[function MimeTactic:CheckForDetach()

	local squad_pos = self.squad_ai:GetPosition()
	if (not self.squad_ai:IsInCombat() and not self.squad_ai:WasRecentlyHurt()) then
	  
		-- Detach commanders after combat
		if (self.squad_ai:HasSquadAttached( "harlequin_squad_great_harlequin" ) or 
			self.squad_ai:HasSquadAttached( "harlequin_squad_shadowseer" )) then	
		 
			self.squad_ai:DoDetachSquad()
			self.squad_ai:DoSetDefaultMeleeStance()		 
		end
	  
	elseif ((self.squad_ai:HasSquadAttached( "harlequin_squad_great_harlequin" ) or
			self.squad_ai:HasSquadAttached( "harlequin_squad_shadowseer" )) and 
			Ability.Filters.CloseEnemy( squad_pos, 10 , 1 ) ~= nil) then 
	  
		-- Detach commanders in close combat
		self.squad_ai:DoDetachSquad()
		self.squad_ai:DoSetDefaultMeleeStance()
	end
	
	-- Call basic detach method
	InfantryTactic.CheckForDetach(self)
end]]


