----------------------------------------
-- File: 'wraithtactic.ai'
-- Edited by Arkhan 	@ 27.10.2006
-- Edited by Thudmeizer @ 25.09.2023

class 'WraithTactic' (NecronInfantryTactic)

function WraithTactic:__init( squad_ai ) super( squad_ai )
		
	self:SetName("Wraith Tactic")
	
	self.m_iPhaseShiftID = cpu_manager.stats:GetAbilityID( "necron_wraith_phase_shift" )
	self.m_iPhaseShiftBID = cpu_manager.stats:GetAbilityID( "necron_wraith_phase_shift_advance_sp" )
end

function WraithTactic:DoAbilities()

	-- Wraith Ability   
	if (self.squad_ai:IsInCombat()) then

		-- Check if I can do phase shift!
      		if (self.m_iPhaseShiftID == nil) then
        		self.m_iPhaseShiftID = cpu_manager.stats:GetAbilityID( "necron_wraith_phase_shift" )
		end
		
		if self.squad_ai:CanDoAbility(necron_wraith_phase_shift) then
			Ability.DoAbility( self.squad_ai, self.m_iPhaseShiftID, Ability.PredicateFilters.IsLowHealthAndUnderAttack , { min_health = 0.4 })
		end

		-- Check if I can do phase shift!
      		if (self.m_iPhaseShiftBID == nil) then
        		self.m_iPhaseShiftBID = cpu_manager.stats:GetAbilityID( "necron_wraith_phase_shift_advance_sp" )
		end

		if self.squad_ai:CanDoAbility(necron_wraith_phase_shift_advance_sp) then
			Ability.DoAbility( self.squad_ai, self.m_iPhaseShiftBID, Ability.PredicateFilters.IsLowHealthAndUnderAttack , { min_health = 0.4 })
		end
	end
end

function WraithTactic:CanOnlyDecap()
	return true
end
