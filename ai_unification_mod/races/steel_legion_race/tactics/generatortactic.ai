----------------------------------------
-- File: 'generatortactic.ai'
-- Edited by Thudmeizer		@ 23.08.2022

class 'GeneratorTactic' (BaseTactic)

Generator = {}

function GeneratorTactic:__init( base_ai ) super( base_ai )

	self:SetName("Power Generator Tactic")

	ResourcesGenTMR = g_iGMT
end

function GeneratorTactic:InitAbilities()

	if Generator.overload_id == nil then
		Generator.overload_id = cpu_manager.stats:GetAbilityID( "steel_legion_power_surge" )
	end
end

function GeneratorTactic:DoAbilities()

	-- Check resource needs every (at least) 6 secs, to avoid issues with multiple ability castings
	if g_iGMT > ResourcesGenTMR + 6 then
    		local iReq = resource_manager:GetResourceAmount():Get( ResourceAmount.RT_Requisition )
    		local iPow = resource_manager:GetResourceAmount():Get( ResourceAmount.RT_Power )

    		-- Check if we have enough Req to dump toward Power
    		if iReq > 300 then
       		-- Check if we actually need Power
        		if iPow < 200 then
            		-- Dump Requisition for Power
            		if self.base_ai:CanDoAbility(Generator.overload_id) then
                			self.base_ai:DoSpecialAbility(Generator.overload_id)
					--print("Using Power Surge ability for player "..tostring(cpu_manager.player_id).."")
                			ResourcesGenTMR = g_iGMT
				end
			end
		end
	end
end