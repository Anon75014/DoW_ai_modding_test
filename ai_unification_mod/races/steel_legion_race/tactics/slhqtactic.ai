----------------------------------------
-- File: 'slhqtactic.ai'
-- Edited by Thudmezier		@ 26.09.2022

class 'SLHQTactic' (BaseTactic)

SLHQ = {}

function SLHQTactic:__init( base_ai ) super( base_ai )

	self:SetName("Steel Legion HQ Tactic")
end

function SLHQTactic:InitAbilities()

	-- Init ability ID's
	if (SLHQ.detection_id == nil) then
		SLHQ.detection_id = cpu_manager.stats:GetAbilityID("steel_legion_detection_field")
	end
end

function SLHQTactic:DoAbilities()

	-- Try to activate detection field
	if (self.base_ai:CanDoAbility(SLHQ.detection_id)) then
	
		local iRange = self.base_ai:GetAbilityRange(SLHQ.detection_id)
		local oSquad = Ability.Filters.CloseInfiltratedEnemy(self.base_ai:GetPosition(), iRange, 1)
		if (oSquad ~= nil) then
			
			-- Only try to detect if the infiltrated unit is attacking
			if (oSquad:IsAttacking()) then
				self.base_ai:DoSpecialAbilitySquad(SLHQ.detection_id, oSquad:GetSquad())
			end
		end
	end
end
